# 项目结构说明

本文档说明MAPF-AGV项目的文件组织结构。

## 目录结构

```
MAPF-AGV/
├── CMakeLists.txt          # CMake构建配置文件
├── README.md               # 项目主说明文档
├── .gitignore              # Git版本控制忽略文件
├── build.bat               # Windows构建脚本（CMD版本）
├── build.ps1                # Windows构建脚本（PowerShell版本）
│
├── docs/                   # 文档目录
│   ├── 算法说明.md         # 控制算法详细说明（4种算法）
│   ├── 运动学模型说明.md   # Ackermann转向模型说明
│   ├── 构建说明.md         # 构建和编译详细说明
│   └── 项目结构说明.md     # 本文件
│
├── src/                    # 源代码目录
│   ├── main.cpp            # 程序入口点
│   │
│   ├── core/               # 核心模块（车辆和地图）
│   │   ├── vehicle.h       # 车辆类定义
│   │   ├── vehicle.cpp     # 车辆类实现（Ackermann运动学模型）
│   │   ├── map.h           # 地图类定义
│   │   └── map.cpp         # 地图类实现
│   │
│   ├── control/            # 控制模块
│   │   ├── controller.h    # 控制器类定义（4种控制算法）
│   │   └── controller.cpp  # 控制器类实现
│   │
│   └── ui/                 # 用户界面模块
│       ├── mainwindow.h    # 主窗口类定义
│       ├── mainwindow.cpp  # 主窗口类实现
│       ├── mapwidget.h     # 地图绘制组件类定义
│       └── mapwidget.cpp   # 地图绘制组件类实现（坐标转换、绘制）
│
└── build/                  # 构建输出目录（由CMake生成，不提交到版本控制）
    └── ...
```

## 模块说明

### 1. 核心模块 (core/)

包含项目的基础类和数据结构：

- **Vehicle类** (`vehicle.h/cpp`)
  - 4轮AGV车辆模型
  - Ackermann转向运动学模型
  - 车辆属性（长度、宽度、轴距等）
  - 位置和姿态管理
  - 轨迹记录

- **Map类** (`map.h/cpp`)
  - 方形空间地图管理
  - 地图边界检查
  - 坐标范围限制

### 2. 控制模块 (control/)

包含车辆控制算法：

- **Controller类** (`controller.h/cpp`)
  - 4种控制算法实现：
    1. 先旋转再前进
    2. 边旋转边前进
    3. PID控制（推荐）
    4. Pure Pursuit
  - 目标点设置和管理
  - 控制参数配置
  - 到达判断

### 3. UI模块 (ui/)

包含用户界面相关代码：

- **MainWindow类** (`mainwindow.h/cpp`)
  - 主窗口界面
  - 控制面板
  - 仿真循环管理
  - 用户交互处理

- **MapWidget类** (`mapwidget.h/cpp`)
  - 地图绘制组件
  - 坐标转换（世界坐标 ↔ 屏幕坐标）
  - 车辆、轨迹、目标点绘制
  - 坐标轴和标尺绘制
  - 鼠标事件处理

### 4. 程序入口 (main.cpp)

- 初始化Qt应用程序
- 创建并显示主窗口
- 事件循环管理

## 文件依赖关系

```
main.cpp
  └── ui/mainwindow.h
      ├── ui/mapwidget.h
      │   ├── core/vehicle.h
      │   ├── core/map.h
      │   └── control/controller.h
      ├── core/vehicle.h
      ├── core/map.h
      └── control/controller.h
          ├── core/vehicle.h
          └── core/map.h
```

## 构建系统

### CMake配置

- **CMakeLists.txt**: 根目录的CMake配置文件
  - 设置C++标准（C++17）
  - 查找Qt库
  - 配置源文件和头文件
  - 链接Qt库

### 构建脚本

- **build.bat**: Windows CMD构建脚本
  - 自动检测CMake和编译器
  - 自动查找Qt路径
  - 配置和编译项目

- **build.ps1**: Windows PowerShell构建脚本
  - 功能与build.bat相同
  - 提供彩色输出和更好的错误处理

## 文档结构

- **README.md**: 项目主说明文档
  - 功能特性
  - 编译步骤
  - 使用方法
  - 算法概述

- **docs/算法说明.md**: 控制算法详细说明
  - 4种算法的数学公式
  - 控制逻辑说明
  - 参数调优建议

- **docs/运动学模型说明.md**: 车辆运动学模型说明
  - Ackermann转向模型原理
  - 数学公式推导
  - 物理约束说明

- **docs/构建说明.md**: 构建和编译详细说明
  - 环境要求
  - 详细编译步骤
  - 常见问题解决

## 版本控制

- **.gitignore**: Git忽略文件配置
  - 忽略构建输出目录
  - 忽略IDE配置文件
  - 忽略临时文件

## 设计原则

1. **模块化设计**: 按功能将代码分为core、control、ui三个模块
2. **清晰的依赖关系**: 模块间依赖关系明确，避免循环依赖
3. **文档完善**: 每个模块和算法都有详细文档说明
4. **易于扩展**: 模块化结构便于添加新功能

## 扩展建议

如果需要添加新功能，建议：

1. **新算法**: 在 `control/controller.cpp` 中添加新的算法函数
2. **新UI组件**: 在 `ui/` 目录下添加新的组件类
3. **新核心类**: 在 `core/` 目录下添加新的基础类
4. **新文档**: 在 `docs/` 目录下添加相应的说明文档


